<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <style>
        a {
            cursor: pointer;
        }
    
        .tooltip-inner b {
            color: lawngreen;
        }
    
        .tooltip-inner b.r {
            color: #ff5722;
        }
    
        .tooltip-inner {
            text-align: left;
            max-width: 400px;
            width: 400px;
        }
    
        .tooltip-inner table tr {
            border-bottom: 1px solid white;
        }
    
        .tooltip-inner ul {
            padding-left: 15px;
        }
    
        .hidden {
            visibility: hidden;
        }
    
        body {
            background-color: #333;
        }
    
        .label-success {
            background-color: #dff0d821 !important;
            color: #deffdf57 !important;
        }
    
        h4 {
            font-weight: bold;
            color: dodgerblue;
        }
    
        .sub {
            color: darkgoldenrod;
        }
    
        .label-warning {
            background-color: #f0ad4e6e !important;
        }
    
        .label-danger {
            background-color: #e91e63 !important;
        }
    </style>
    <script>
        function changeTitles() {
            let links = document.getElementsByTagName("a");
            for (let link of links) {
                let tooltipId = link.attributes.title.value;
                let tooltip = document.getElementById(tooltipId);
                link.setAttribute("data-toggle", "tooltip");
                link.setAttribute("data-placement", "auto right");
                link.setAttribute("data-html", "true");
                let current = link.getAttribute("class");
                if (current) {
                    link.setAttribute("class", current + " label");
                } else {
                    link.setAttribute("class", "label label-success");
                }
                if (tooltip) {
                    link.setAttribute("title", tooltip.innerHTML);
                }
            }
            $(document).ready(function () {
                $('[data-toggle="tooltip"]').tooltip();
            });
        }
    </script>
</head>
<body onload="changeTitles()" class="container">
<div>
    <h4>General</h4>
    <ul>
        <li>
            <b class="sub">Application context:</b>
            <a title="a1_1">what is</a>
            <a title="a1_2">lifecycle</a>
            <a title="a1_3" class="label-danger">configuration</a>
            <a title="a1_4" class="label-warning">usage in test</a>
            <a title="a1_5">closing context</a>
            <a title="a1_6" class="label-warning">namespaces</a>
        </li>
        <li>
            <b class="sub">Beans:</b>
            <a title="a2_1" class="label-danger">lifecycle</a>
            <a title="a2_2" class="label-warning">scope</a>
            <a title="a2_3" class="label-danger">IDs</a>
            <a title="a2_4" class="label-warning">scanning</a>
            <a title="a2_5">stereotypes</a>
            <a title="a2_6" class="label-danger">lazy/eager init</a>
            <a title="a2_7" class="label-danger">final/static</a>
            <a title="a2_8" class="label-danger">init/destroy</a>
            <a title="a2_9" class="label-warning">depends-on</a>
        </li>
        <li>
            <b class="sub">DI, IOC:</b>
            <a title="a3_1">what is</a>
            <a title="a3_2">@Autowired</a>
            <a title="a3_5">scalar/literal injection</a>
            <a title="a3_6" class="label-danger">@Value</a>
            <a title="a3_7">$ vs #</a>
            <a title="a3_8">lookup method</a>
        </li>
        <li>
            <b class="sub">Properties:</b>
            <a title="a4_1">PropertySource</a>
            <a title="a4_2" class="label-danger">PropertySourcesPlaceholderConfigurer</a>
            <a title="a4_3">PropertyResolver</a>
        </li>
        <li>
            <b class="sub">PostProcessors:</b>
            <a title="a5_1">BeanFactoryPostProcessor</a>
            <a title="a5_2" class="label-danger">BeanPostProcessor</a>
            <a title="a5_3">order</a>
        </li>
        <li>
            <b class="sub">Profiles:</b>
            <a title="a6_1">what is</a>
            <a title="a6_2">usage</a>
            <a title="a6_3">limitations</a>
        </li>
        <li>
            <b class="sub">Environment:</b>
            <a title="a7_1">what is</a>
            <a title="a7_2">property sources</a>
        </li>
        <li>
            <b class="sub">SpEL:</b>
            <a title="a8_1">what is</a>
            <a title="a8_2">usage</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="a1_1">
            <b>ApplicationContext</b>
            is a Spring IoC container responsible for:
            <ul>
                <li>instantiating</li>
                <li>configuring</li>
                <li>assembling the beans from configuration</li>
            </ul>
        </div>
        <div id="a1_2">
            <ul>
                <li>Initialization
                    <ul>
                        <li>context created</li>
                        <li>beans loaded</li>
                        <li>injected</li>
                        <li>initialized</li>
                        <li>resources are allocated</li>
                    </ul>
                </li>
                <li>Use</li>
                <li>Destruction
                    <ul>
                        <li>context destroyed</li>
                        <li>resources released</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="a1_3">
            <ul>
                <li>
                    <b>XML config</b>
                    <ul>
                        <li>Define beans in xml</li>
                        <li>Add <b>&lt;context:component-scan></b> - automatically detects stereotyped classes and turns on the
                            <b>&lt;context:annotation-config></b> (activates the Spring infrastructure for various annotations
                            to be detected in bean classes, including the JSR-250 annotations)</li>
                        <li>new <b class="r">ClassPathXmlApplicationContext</b>("lifacycle-config.xml"); (<b class="r">"classpath:"</b>
                            is added implicitly to this string. Also ClassPathXmlApplicationContext starts looking from
                            <b class="r">root</b> of the classpath regardless of whether specify "/")</li>
                    </ul>
                </li>
                <li>
                    <b>Java config</b>
                    <ul>
                        <li>Define <b>@Configuration</b> with a <b class="r">mandatory no-args constructor</b></li>
                        <li>Define <b>@Bean</b> in @Configuration/@Component</li>
                        <li>new <b class="r">AnnotationConfigApplicationContext</b>(JavaApplicationConfig.class);</li>
                    </ul>
                </li>
                <li>
                    <b>Java annotations</b>
                    <ul>
                        <li>Add @ComponentScan to the @Configuration</li>
                        <li>Add @ContextConfiguration to the class where bean need to be injected.
                            (if no location is defined Spfing will try to load config my naming convention i.e. MyClass-context.xml)
                            Annotation params:
                            <ul>
                                <li>"locations", (default) "value" - path to XML configuration</li>
                                <li>"classes" - varargs parameter with a Configuration classes</li>
                                <li>"inheritLocations" (boolean) - can change default behavior of inheriting
                                    configuration class (location)
                                </li>
                            </ul>
                        </li>
                        <li>Annotate bean class as
                            <b>@Component</b>
                        </li>
                        <li>Inject bean with
                            <b>@Autowired</b>
                        </li>
                    </ul>
                </li>
            </ul>
            <br/>
            Configuration with <b class="r">@Import</b>(AnotherConfig.class) import beans provided config.<br/><br/>
            <b class="r">Important</b>: In case imported two configurations with the same named beans defined Spring will
            take <b>the last one</b>. E.g. In @Import({Conf1.class, Conf2.class}) Spring will take the same named bean from Conf2.
            If the load <b>order</b> of configuratino will be switched: Conf2 via Order(1) or Conf1 via Order(2) then bean will be taken
            from Conf1 as the last one.
        </div>
        <div id="a1_4">
            <ul>
                <li>implement the <b>ApplicationContextAware</b> interface and obtain context in setter</li>
                <li>extend <b>AbstractJUnit4SpringContextTests</b> / <b>AbstractTestNGSpringContextTests</b> and get
                    access for their protected ApplicationContext field
                </li>
                <li>inject <b>ApplicationContext</b></li>
            </ul>
        </div>
        <div id="a1_5">
            <ul>
                <li>For WEB: closed automatically</li>
                <li>For non-WEB:
                    <ul>
                        <li><b>registerShutdownHook()</b>: app context will be closed on JVM shutdown (applied by
                            default
                            in Spring Boot);
                        </li>
                        <li><b>close()</b>: app context will be closed immediately</li>
                    </ul>
                </li>
            </ul>
            It's possible to <b>listen to an ContextClosedEvent</b> using ConfigurableApplicationContext.<b>addApplicationListener</b> to do some
            actions before close() of registerShutdownHook()
        </div>
        <div id="a1_6">
            Available namespaces:
            <ul>
                <li><b>c</b> - ingesting by constructor arguments</li>
                <li><b>p</b> - ingesting by setters</li>
                <li><b>util</b>
                    <ul>
                        <li>util:constant - accessing constants in config</li>
                        <li>util:properties - reading properties from a file</li>
                        <li>util:list, util:set, util:map - creating collections</li>
                    </ul>
                </li>
                <li><b>jdbc</b> - e.g. <b class="r">jdbc:embedded-database</b></li>
                <li><b>context</b> - e.g. <b class="r">context:property-placeholder</b> reads properties from a file</li>
                <li><b>aop</b> - e.g. <b class="r">aop:aspectj-autoproxy</b> enables detection of @Aspect bean</li>
                <li><b>tx</b> - e.g. <b class="r">tx:annotation-driven</b> - transactional behavior based on annotations
                    and <b class="r">tx:advice</b> creates transactional advice</li>
                <li>others...</li>
            </ul>
        </div>
        All namespaces are imported as: xmlns:<b>name</b>="http://www.springframework.org/schema/<b>name</b>" + XSD if required.
    </div>

    <div class="hidden">
        <div id="a2_1">
            <ul>
                <li>Load Bean definitions
                    <ul>
                        <li>Bean Definitions are loaded</li>
                        <li>Bean Definitions are processed</li>
                    </ul>
                </li>
                <li>Create Beans
                    <ul>
                        <li>constructor call</li>
                        <li>setter call</li>
                        <li>postprocessor “init” methods call</li>
                    </ul>
                </li>
                <li>Beans are ready and being used</li>
                <li>Beans are destroyed
                    <ul>
                        <li>destroy method call</li>
                        <li>handing over to garbage collector</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="a2_2">
            <ul>
                <li>
                    <b>singleton</b>
                    (default) - one object instance per IoC container. Ideally used for <b class="r">stateless</b> beans.
                </li>
                <li>
                    <b>prototype</b>
                    - one object instance per bean request from container. Ideally used for <b class="r">stateful</b> beans.
                    Configured <b class="r">destruction</b> lifecycle callbacks are <b class="r">not called</b> on prototypes -
                    client code must clean up prototype-scoped objects and release resources that the prototype bean is holding
                    (e.g. using a custom bean post-processor)
                </li>
                <li>[web only] <b>request</b> - each HTTP request has new instance
                </li>
                <li>[web only] <b>session</b> - one object instance per HTTP session lifecycle
                </li>
                <li>[web only] <b>application</b> - one object instance per ServletContext lifecycle
                </li>
                <li>[web only] <b>websocket</b> - one object instance per WebSocket lifecycle
                </li>
            </ul><br/>
            Note: if a singleton depends on prototype then this Prototype bean will be created on container
            creation.<br/>
            <b>Custom scope</b> is done through implementation of interface <b class="r">Scope</b>.
        </div>
        <div id="a2_3">
            @Bean parameters:
            <ul>
                <li><b>value</b> (default param e.g. @Bean("bName")) - bean name and aliases</li>
                <li><b>name</b> - bean name and aliases</li>
            </ul>
            * 'name' and 'value' are both <b>arrays</b> with identical functionality<br/>
            * @Bean doesn't have '<b class="r">id</b>' or '<b class="r">alias</b>' property<br/>
            * @Bean's default name will be the same as the method name
            <br/><br/>

            &lt;bean/> parameters:
            <ul>
                <li><b>id</b> - exactly one unique identifier for a bean</li>
                <li><b>name</b> - can be used to create one or more aliases</li>
            </ul>
            * aliases can be separated by any number of spaces, commas, or semi-colons (or any mixture of the three)
            <br/><br/>

            In case the name/id is not defined:
            <ul>
                <li><b>@Bean</b> takes the <b class="r">method's name</b></li>
                <li><b>&lt;bean/></b> is considered anonymous and container generates a unique id for that bean:
                    fully qualified <b class="r">class name</b> and appened <b class="r">number</b></li>
            </ul>
        </div>
        <div id="a2_4">
            Responsible for searching beans to register.
            <br/>
            Turned on:
            <ul>
                <li><b>@ComponentScan</b>("com.path")
                </li>
                <li>&lt;context:<b>component-scan</b> base-package="com.path"/>
                </li>
            </ul>
            <br/>
            Detects
            <ul>
                <li>Stereotypes: @Component, @Controller, @Repository, @Service, @RestController</li>
                <li>Other: @ControllerAdvice, @Configuration</li>
            </ul><br/><br/>
            Doesn't require @Configuration to work.
        </div>
        <div id="a2_5">
            Stereotypes ("stereotype" package):
            <br/>
            define the roles class in architecture (eventually targets for pointcuts).
            <br/>
            Stereotypes are:
            <ul>
                <li>
                    <b>@Component</b>
                </li>
                <li>Specializations meta-annotatated with @Component
                    <ul>
                        <li>
                            <b>@Controller</b>
                        </li>
                        <li>
                            <b>@RestController</b> (not from stereotype package but still considered as a stereotype by the Spring spec)
                        </li>
                        <li>
                            <b>@Repository</b>
                        </li>
                        <li>
                            <b>@Service</b>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="a2_6">
            <b>Only singletons</b> are <b>eagerly</b> instantiated by default.
            <br/>
            To alter:
            <ul>
                <li>&lt;bean id="lazy" class="com.foo.HeavyBean" <b>lazy-init</b>="true"/> or<br/>
                    &lt;beans <b>default-lazy-init</b>="true">
                </li>
                <li>
                    <b>@Lazy</b> for @Bean or class with beans. Annotation has the only boolean argument "value" that
                    can turn on/off lazy loading (e.g. <b>@Lazy(false)</b>)
                </li>
            </ul><br/>
            <b class="r">Note</b>: when a lazy-initialized bean is a dependency of a singleton bean that
            is not lazy-initialized, the ApplicationContext creates the lazy-initialized bean at startup, because it must satisfy the singleton’s dependencies.
        </div>
        <div id="a2_7">
            non-static @Bean methods in @Configuration classes need to be overridable,
            <br/>
            i.e. they must not be declared as private or final.
            <br/>
            <br/>
            <b>Static beans features</b>:
            <ul>
                <li>allows a method to be called without creating its containing configuration class as an instance</li>
                <li>It is necessary when beans will get initialized early in the container lifecycle</li>
                <li>It avoids triggering other parts of the configuration at that point of definition</li>
                <li>they will <b class="r">never get intercepted by the container, not even within @Configuration classes</b></li>
                <li>static methods can be final though it doesn't make sense.</li>
            </ul>
        </div>
        <div id="a2_8">
            <b>Init method</b> - called as a callback after bean is created, assembled and <b>all the bean properties are set</b>.
            Declaring options:
            <ul>
                <li>
                    <b>@PostConstruct</b> [JSR-250] (Java config, best practice)
                </li>
                <li>
                    <b>custom init</b> method (Java and XML config)
                    <ul>
                        <li>XML: &lt;beans default-init-method="init"/> or<br/>
                            &lt;bean <b class="r">init-method</b>="init"/></li>
                        <li>Java: @Bean(initMethod = "init")</li>
                    </ul>
                </li>
                <li>
                    <b>afterPropertiesSet()</b>
                    from InitializingBean callback interface (not recommended since
                    couples the code to Spring)
                </li>
            </ul>
            <br/>

            <b>Destruction method</b>
            called on closing the application context. Declaring options:
            <ul>
                <li>
                    <b>@PreDestroy</b>
                    [JSR-250] (Java config, best practice)
                </li>
                <li>
                    <b>custom destroy</b> method (Java and XML config)
                    <ul>
                        <li>XML: &lt;beans default-destroy-method attribute="destroy"/> or &lt;bean destroy-method="destroy"/></li>
                        <li>Java: @Bean(destroyMethod = "destroyMethod")</li>
                    </ul>
                </li>
                <li>
                    <b>destroy()</b>
                    from DisposableBean callback interface (not recommended)
                </li>
            </ul><br/><br/>
            Sequence of calling for init and destroy phases are the same:
            <ul>
                <li><b class="r">before init/destroy BeanPostProcessor</b> call (@PostConstruct / @PreDestroy)</li>
                <li><b class="r">Spring specific</b> interface control (afterPropertiesSet / destroy)</li>
                <li><b class="r">custom init/destroy</b> methods defined in mean annotation/tag arguments</li>
            </ul>

            <br/>
            <b class="r">CommonAnnotationBeanPostProcessor</b> provides support for all JSR annotations. Registered within Spring Application context.
            <br/><br/>
            All of the above can be used on the <b class="r">Configuration</b> as well since its instance will participate in lifacycle.
        </div>
        <div id="a2_9">
            Bean's property <b class="r">@DependsOn</b> or depends-on (XML) informs Spring that some another bean must be created before.
        </div>
    </div>

    <div class="hidden">
        <div id="a3_1">
            DI(IoC) is a technique where one object supplies the dependencies of another object
        </div>
        <div id="a3_2">
            @Autowired:
            <ul>
                <li><b>injects</b> a bean</li>
                <li>handled by Spring <b>BeanPostProcessor</b></li>
                <li>makes injection <b>mandatory</b>. Fails if nothing to inject</li>
                <li>only <b>one constructor</b> can be Autowired, <b>but</b> multiple constructors can be marked as @Autowired(required = false)</li>
                <li>can autowire <b>Map</b> (key:bean name (String only), value:bean of the expected type)</li>
                <li>can autowire <b class="r">array</b> which will have all the beans of array elements type</li>
                <li>applied on a <b>method/constructor</b> will make sure that all arguments will be loaded as beans from AppContext</li>
            </ul><br/>
            Equivalents:
            <ul>
                <li><b>@Inject</b> (javax.injectx package): use with @Qualifier from javax.inject to specify name of the bean to inject</li>
                <li><b>@Resource</b> (javax.annotation package): provides a name attribute to specify name of the bean to inject</li>
            </ul><br/>
            <b>@Required</b> - An exception will be thrown if @Required dependency is not set.<br/>
            <b>@Qualifier</b> defines exact bean name if injection by type finds multiple implementations.
            Can be used on <b class="r">Field, Method, Method's parameter, Class</b><br/><br/>
            <b class="r">Private fields</b> are injected the same way as public.
        </div>

        <div id="a3_5">
            <ul>
                <li>XML: by adding "value" attribute to "property" or "constructor-arg"</li>
                <li>Class: using @Value</li>
            </ul>
        </div>
        <div id="a3_6">
            <ul>
                <li>handled by Spring <b>BeanPostProcessor</b></li>
                <li>can be placed on <b class="r">fields, methods and method/constructor parameters</b></li>
                <li>used for <b>expression-driven dependency injection</b></li>
                <li>supported for dynamic resolution of handler method parameters e.g. in Spring MVC</li>
                <li>an expression resolver is preconfigured to look for bean names when resolving expression text (<b class="r">#{}</b>)</li>
                <li>applied on the <b class="r">method/constructor</b> will make sure that Value will be injected to the
                    method/constructor arguments (string Value will be converted to appropriate type defined in parameter)</li>
            </ul>
        </div>
        <div id="a3_7">
            <ul>Used in @Value
                <li><b>#{}</b> - SpEL expression. Inside the expression variables can be references by #newName, #this, #root
                </li>
                <li><b>${}</b> - "${" is a "placeholder prefix". ${} expression internally will be handled by
                    PropertyResolver.resolvePlaceholders
                </li>
            </ul>
        </div>
        <div id="a3_8">
            <b>Lookup Method Injection</b> replaces method (or implements if abstract) logic with searching a bean in
            the container. If called, the method marked as a "lookup" will simply return found bean. If lookup bean name
            is not defined, container will try to identify searching bean by the method return type.
            <br/><br/>
            Implementations:
            <ul>
                <li><b>@Lookup</b>("otherBean")<br/>
                    abstract Command getOtherBean()</li>
                <li><<b>lookup-method</b> name="getOtherBean" bean="otherBean"/></li>
            </ul><br/>
            Implemented using <b>CGLIB</b>.
        </div>
    </div>

    <div class="hidden">
        <div id="a4_1">
            Declaration:
            <ul>
                <li><b>@PropertySource</b>("classpath:/com/myco/app.properties")
                </li>
            </ul>
            <br/>
            Usage
            <ul>
                <li>@Autowired Environment env; <b>env.getProperty</b>("testbean.name");
                </li>
                <li><b>@Value</b>("${testbean.name}")
                </li>
            </ul>
        </div>
        <div id="a4_2">
            <ul>
                <li>specialization of <b class="r">PlaceholderConfigurerSupport</b></li>
                <li>predefined bean factory <b>post-processor</b></li>
                <li>newer and more flexible version of PropertyPlaceholderConfigurer</li>
                <li><b>Resolves</b> ${} <b class="r">placeholders</b> in bean definition property values and
                    resulves <b class="r">@Value</b> annotations against the
                    current Spring Environment and its set of PropertySources
                </li>
            </ul>
        </div>
        <div id="a4_3">
            "${}" expression internally handled by PropertyResolver.resolvePlaceholders
        </div>
    </div>

    <div class="hidden">
        <div id="a5_1">
            <ul>
                <li>operates on the bean configuration metadata</li>
                <li>can change the actual bean definition (i.e., the blueprint that defines the bean)</li>
                <li>can modify the application context's internal bean factory after the context's standard initialization</li>
            </ul>
        </div>
        <div id="a5_2">
            Operates on already created bean in phases:
            <ul>
                <li>Before initialization callbacks (afterPropertiesSet, init-method)</li>
                <li>After initialization callbacks (afterPropertiesSet, init-method)</li>
            </ul>
        </div>
        <div id="a5_3">
            Both BeanPostProcessor and BeanFactoryPostProcessor, can control the order in which they execute by
            implementing the <b>Ordered</b> or <b>PriorityOrdered</b> interface, not just BeanFactoryPostProcessor.
        </div>
    </div>

    <div class="hidden">
        <div id="a6_1">
            Is a mechanism that allows for <b>registration of different beans in different environments</b>
            <br/>
            Default profile is a "<b>default</b>".
            <br/>
            <br/>
            Useful when (examples):
            <ul>
                <li>Easily changing data sources: in-memory datasource in development, from JNDI for QA</li>
                <li>registering monitoring infrastructure only when deploying an application into a performance
                    environment
                </li>
                <li>registering customized implementations of beans for customer A vs customer B deployments</li>
            </ul>
        </div>
        <div id="a6_2">
            <ul>
                <li>Java: <b>@Profile</b> on @Configuration/@Component/@Bean</li>
                <li>XML: '<b>profile</b>' attribute on &lt;beans></li>
            </ul>
            <br/>
            Activation:
            <ul>
                <li>-D<b>spring.profiles.active</b>="profile1,profile2"</li>
                <li>ctx.getEnvironment().<b>setActiveProfiles</b>("profile1", "profile2")</li>
            </ul>
            <br/>
            Arguments
            <ul>
                <li>@Profile("development")</li>
                <li>@Profile({"p1", "p2"})</li>
                <li>@Profile("<b>!</b>development")  - anything other than "development"</li>
            </ul>
        </div>
        <div id="a6_3">
            It is possible to have <b>MAX array size</b> different profiles expected for registered bean
        </div>
    </div>

    <div class="hidden">
        <div id="a7_1">
            <ul>
                <li>integrated in the container</li>
                <li>contains
                    <ul>
                        <li><b>profiles</b>: which is currently active</li>
                        <li><b>properties</b>: configuring property sources and resolving properties from them</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="a7_2">
            <ul>
                <li>Command line arguments</li>
                <li>Java System properties (System.getProperties())</li>
                <li>OS environment variables (System.getenv())</li>
                <li>Spring Boot application.properties</li>
                <li>Default Properties (set by <b class="r">SpringApplication.setDefaultProperties</b>)</li>
                <li>And many more:
                    https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html
                </li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="a8_1">
            Spring Expression Language supports <b>querying and manipulating an object graph at runtime</b>
            <br/><br/>
            Functionality:
            <ul>
                <li>Literal expressions</li>
                <li>Boolean and relational operators</li>
                <li>Regular expressions</li>
                <li>Class expressions</li>
                <li>Accessing properties, arrays, lists, maps</li>
                <li>Method invocation</li>
                <li>Relational operators</li>
                <li>Assignment</li>
                <li>Calling constructors</li>
                <li>Bean references</li>
                <li>Array construction</li>
                <li>Inline lists</li>
                <li>Inline maps</li>
                <li>Ternary operator</li>
                <li>Variables</li>
                <li>User defined functions</li>
                <li>Collection projection</li>
                <li>Collection selection</li>
                <li>Templated expressions</li>
            </ul>
        </div>
        <div id="a8_2">
            <ul>
                <li>
                    Manually: <br/>
                    <b>ExpressionParser.parseExpression</b> (from "org.springframework.expression" package)
                </li>
                <li>In Bean Definitions:
                    <ul>
                        <li>XML Config: &lt;property name="prop"
                            <br/>
                            value="<b>#{ T(java.lang.Math).random() * 100.0 }</b>"/>
                        </li>
                        <li>Annotation Config:
                            <br/>
                            @Value("<b>#{ systemProperties['user.region'] }</b>")
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<div>
    <h4>AOP</h4>
    <ul>
        <li>
            <b class="sub">AOP:</b>
            <a title="b1_1">what is</a>
            <a title="b1_2">in Spring</a>
            <a title="b1_3">configuration</a>
        </li>
        <li>
            <b class="sub">Terminology:</b>
            <a title="b2_1">aspect</a>
            <a title="b2_2" class="label-warning">advice</a>
            <a title="b2_3">cross-cutting concern</a>
            <a title="b2_4">pointcut</a>
            <a title="b2_5">join point</a>
            <a title="b2_6">weaving</a>
        </li>
        <li>
            <b class="sub">Proxy:</b>
            <a title="b3_1">what is</a>
            <a title="b3_2" class="label-warning">types</a>
            <a title="b3_3">benefits</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="b1_1">
            Is a paradigm that aims to increase modularity by separation of cross-cutting concerns
        </div>
        <div id="b1_2">
            <ul>
                <li>implemented in pure Java</li>
                <li>supports only method execution join points</li>
                <li>introduced in Spring to provide a close integration with Spring IoC to help solve common problems in
                    enterprise applications
                </li>
            </ul><br/>
            AspectJ library is used for weaving. All annotations used for AOP in spring are used from AspectJ library
            (e.g. @Around, @Before, @Aspect, etc.)
        </div>
        <div id="b1_3">
            Once @AspectJ support enabled - <b>all @Aspect marked classes will be automatically detected and used</b> to configure
            AOP. <b>Important</b>: "@AspectJ" is not an annotation, but a name of tbe libtaty the way it's used in the Spring spec and on the exam.
            <br/>
            <br/>
            Enabling @AspectJ support:
            <ul>
                <li>add <b class="r">aspectjweaver.jar</b> to classpath</li>
                <li>Java config: <b>@EnableAspectJAutoProxy</b></li>
                <li>XML config: &lt;aop:<b>aspectj-autoproxy</b>/>
                </li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="b2_1">
            Is a <b>class containing</b> code specific to a <b>cross-cutting</b> concern (pointcuts and advices).
            <br/>
            <br/>
            In code:
            <ul>
                <li>Java:
                    <b>@Aspect</b>
                </li>
                <li>Xml:
                    <b>
                        &lt;bean class="path.to.MyAspect"/>
                    </b>
                </li>
            </ul>
        </div>
        <div id="b2_2">
            Is an action taken by an aspect at a particular join point. In Sprint - <b>annotated method</b>.
            <br/>
            <br/>
            In code:
            <ul>
                <li>
                    <b>@Before</b>
                    executes before a join point. Execution of join point cannot be stopped unless unless an
                    exception is thrown.
                </li>
                <li>
                    <b>@AfterReturning</b>
                    executed after a join point completes normally (without throwing an exception)
                </li>
                <li>
                    <b>@AfterThrowing</b> executed if a method exits by throwing an exception
                    (<b class="r">"throwing"</b> argument can specify exact exception)
                </li>
                <li>
                    <b>@After</b> executed <b class="r">in any case</b> (if method executed normally or with exception)
                </li>
                <li>
                    <b>@Around</b>
                    executed instead of join point method. Join Point method can be called manually by
                    ProceedingJoinPoint.proceed. The first parameter of the advice method <b>must be</b> of type ProceedingJoinPoint.
                    The only advice which can try/catch exceptions of join point.
                </li>
            </ul>
            <br/>
            Advices can receive JoinPoint as a method argument. @Around can also get ProceedingJoinPoint.
        </div>
        <div id="b2_3">
            A cross-cutting concern is a logic in an application that cannot be decomposed from the rest of the
            application
            and may result in code duplication and tight coupling
            <br/>
            <br/>
            In code:
            <ul>
                <li>
                    <b>logic that can be adviced</b>
                </li>
            </ul>
            <br/>
            Examples of cross-cutting concerns:
            <ul>
                <li>Logging</li>
                <li>Security</li>
                <li>Transaction management</li>
                <li>Caching</li>
            </ul>
            <br/>
            Problems if cross-cutting concerns not used:
            <ul>
                <li>Scattering (code duplication)</li>
                <li>Tangling (significant dependencies between systems)</li>
            </ul>
        </div>
        <div id="b2_4">
            Is an expression that identifies which join point advice should be bind to.
            The advice will be called <b class="r">when</b> the proxy method matches the join point expression.
            <br/><br/>
            <b>Pointcut expressions</b> are defined using AspectJ Pointcut Expression Language.
            <br/><br/>
            In code:
            <ul>
                <li>@Before(<b>"execution(* path.to.MyAopBean.checkPointcut(..))"</b>)
                </li>
                <li>@Before("callMethodWithException()")../some advice/..;
                    <b>@Pointcut</b>(value = "execution(* path.to.AopBean.callMethodWithException())")
                    - for cases when the same point cut expression is duplicated in many advices
                </li>
            </ul>
            <br/>

            Spring AOP supports the following AspectJ pointcut designators
            <ul>
                <li>execution</li>
                <li>this</li>
                <li>within, @within</li>
                <li>target, @target</li>
                <li>args, @args</li>
                <li>@annotation</li>
            </ul><br/>

            Samples:
            <ul>
                <li>execution(public * *(..)) - all public method. Here:
                    <ul>
                        <li>any package - name since no package name</li>
                        <li>* - any return type</li>
                        <li>* - any method name</li>
                        <li>(..) - zero or more number of arguments</li>
                    </ul>
                </li>
                <li></li>
                <li></li>
                <li></li>
            </ul>
        </div>
        <div id="b2_5">
            A point during the execution of a program, such as the execution of a method or the handling of an
            exception. In Spring AOP, a join point always <b>represents a method execution</b>.<br/><br/>
            In code:
            <ul>
                <li>
                    <b>Logic inside an advice</b>
                </li>
            </ul>
        </div>
        <div id="b2_6">
            Is a merging advices and target class. The weaver generates a woven class (an advised object, proxy).<br/>
            Weaving is done at <b>runtime</b>.
        </div>
    </div>

    <div class="hidden">
        <div id="b3_1">
            Is an object created by the AOP framework with merged advices and target class
        </div>
        <div id="b3_2">
            <ul>
                <li><b>JDK dynamic proxy</b>
                    <ul>
                        <li>used by default for beans with <b>interface</b></li>
                        <li>recommended to use</li>
                        <li>proxy will implement the same interface as target object</li>
                        <li>intercepts only <b class="r">public</b> methods</li>
                    </ul>
                </li>
                <li><b>CGLIB proxy</b>
                    <ul>
                        <li>is <b>default for @Configuration</b> and other beans with <b>no interface</b></li>
                        <li>not recommended to use</li>
                        <li>proxy willextend target object</li>
                        <li>adviced methods cannot be final</li>
                        <li>CGLIB classes are under the org.springframework.cglib package and included in the spring-core jar</li>
                        <li>intercepts <b class="r">public, protected and package-visible</b> methods</li>
                    </ul>
                </li>
            </ul><br/>
            Note: CGLIB can be forced for usage by applying <b>proxy-target-class="true"</b>
        </div>
        <div id="b3_3">
            Benefits
            <ul>
                <li>pure Java implementation</li>
                <li>close integration with Spring</li>
            </ul>
            <br/>
            Disadvantages
            <ul>
                <li>only methods join points (no field interception)</li>
                <li>little runtime overhead</li>
                <li>local or internal method calls within an adviced class will not be intercepted</li>
            </ul>
        </div>
    </div>
</div>
<div>
    <h4>Data Management</h4>
    <ul>
        <li>
            <b class="sub">Exceptions:</b>
            <a title="c1_1">hierarchy</a>
            <a title="c1_2">why unchecked</a>
        </li>
        <li>
            <b class="sub">DataSource:</b>
            <a title="c2_1">configuration</a>
            <a title="c2_2">types</a>
            <a title="c2_3">JNDI</a>
        </li>
        <li>
            <b class="sub">JdbcTemplate:</b>
            <a title="c3_1" class="label-warning">what is</a>
            <a title="c3_2" class="label-danger">callbacks</a>
            <a title="c3_21">execute</a>
            <a title="c3_3">queries</a>
            <a title="c3_4">updates</a>
        </li>
        <li>
            <b class="sub">Transactions:</b>
            <a title="c4_1">what is</a>
            <a title="c4_2">types</a>
            <a title="c4_6" class="label-danger">configuration</a>
            <a title="c4_3" class="label-danger">transaction strategy</a>
            <a title="c4_4" class="label-danger">isolation</a>
            <a title="c4_5" class="label-warning">propagation</a>
            <a title="c4_7">@Transactional</a>
            <a title="c4_8" class="label-warning">rollback</a>
        </li>
        <li>
            <b class="sub">ORM:</b>
            <a title="c6_1">what is</a>
            <a title="c6_2">how works</a>
        </li>
        <li>
            <b class="sub">JPA:</b>
            <a title="c7_1">what is</a>
            <a title="c7_2" class="label-warning">configuration</a>
            <a title="c7_3">participation in transaction</a>
        </li>
        <li>
            <b class="sub">Spring data:</b>
            <a title="c8_1">instant repository</a>
            <a title="c8_2" class="label-warning">how works</a>
            <a title="c8_3" class="label-warning">@Query</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="c1_1">
            Data access exceptions hierarchy:
            <ul>
                <li><b>RuntimeException</b>
                    <ul>
                        <li><b class="r">DataAccessException</b>
                            <ul>
                                <li>DataAccessResourceFailureException</li>
                                <li>CleanupFailureDataAccessException</li>
                                <li>InvalidDataAccessApiUsageException</li>
                                <li>InvalidDataAccessResourceUsageException</li>
                                <li>DataRetrievalFailureException</li>
                                <li>OptimisticLockingFailureException</li>
                                <li>UnauthorizedDataAccessException</li>
                                <li>DataintegrityvViolationException</li>
                                <li>DeadlockLoserDataAccessException</li>
                                <li>etc...</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="c1_2">
            <ul>
                <li>best practice for API</li>
                <li>best when it's imossible to do anything useful</li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="c2_1">
            <ul>
                <li>Define properties (DataSourceProperties in Boot). Usually:
                    <ul>
                        <li>"<b>driverClassName</b>"
                        </li>
                        <li>"<b>url</b>"
                        </li>
                        <li>"<b>username</b>"
                        </li>
                        <li>"<b>password</b>"
                        </li>
                    </ul>
                </li>
                <li>Create DataSource with defined properties</li>
                <li>Create environment specific PlatformTransactionManager with created dataSource</li>
            </ul>
        </div>
        <div id="c2_2">
            Package: org.springframework.jdbc.datasource
            <br/>
            <br/>
            Hierarchy:
            <ul>
                <li>(i) javax.sql.DataSource
                    <ul>
                        <li>AbstractDataSource
                            <ul>
                                <li>AbstractRoutingDataSource
                                    <ul>
                                        <li>IsolationLevelDataSourceRouter</li>
                                    </ul>
                                </li>
                                <li>AbstractDriverBasedDataSource
                                    <ul>
                                        <li>
                                            <b>SimpleDriverDataSource</b>
                                        </li>
                                        <li>
                                            <b>DriverManagerDataSource</b> - every time uses new Connection and closes is
                                            after use. <b class="r">Slow</b> for many requests.
                                            <ul>
                                                <li>
                                                    <b>SingleConnectionDataSource</b> - connection is not closed after each use.
                                                    Not thread safe.
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>(i) SmartDataSource
                            <ul>
                                <li>SingleConnectionDataSource</li> - classes using this interface can query whether or
                                not the Connection should be closed after an operation
                            </ul>
                        </li>
                        <li>(i) EmbeddedDatabase
                            <ul>
                                <li>EmbeddedDataSourceProxy</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
            <br/>

            DataSources Builders:
            <ul>
                <li>DataSourceBuilder (Boot)</li>
                <li>
                    <b>EmbeddedDatabaseBuilder</b>
                </li>
            </ul>
            <br/>

            Spring Boot can auto-configure <b>embedded</b>:
            <ul>
                <li><b class="r">H2</b></li>
                <li><b class="r">HSQL</b></li>
                <li><b class="r">Derby</b></li>
            </ul><br/>
            If JARs for those DBs are in the class path Spring will try to configure in-memotry DB only if auto-configuration is
            turn on (@SpringBootApplication or @EnableAutoConfiguration)
        </div>
        <div id="c2_3">
            &lt;jee:jndi-lookup id="dataSource" jndi-name="jdbc/jpetstore"/>
            <br/>
            &lt;bean id="txManager" class="org.springframework.transaction.jta.<b>JtaTransactionManager</b>"/>
            <br/>
            (doesn't need to know about datasource)
        </div>
    </div>

    <div class="hidden">
        <div id="c3_1">
            JdbcTemplate is a <b>JDBC approach</b><br/>
            Named so because of a Template Method pattern that it's based on.<br/>
            Expects <b>DataSource</b> as a controller argument.
            <br/><br/>
            Features:
            <ul>
                <li>creation of statements</li>
                <li>execution of: statements, SQLs, stored procedures</li>
                <li>provides execution results</li>
                <li>creation/releasing connections</li>
                <li>covers JDBC exceptions with more informative</li>
                <li>instance of JdbcTemplate is <b class="r">thread-safe</b> once configured</li>
            </ul><br/>
            <b>Shouldn't be confused with HibernateTemplate.</b>
        </div>
        <div id="c3_2">
            callback ("call-after" function) - called after the other function execution.
            <br/><br/>
            Main JdbcTemplate callbacks:
            <ul>
                <li>
                    <b>PreparedStatementCreator</b>
                    prepare parametrized precompiled statement from a Connection for queries
                </li>
                <li>
                    <b>CallableStatementCreator</b>
                    prepare parametrized statement from a Connection to execute SQL stored procedures
                </li>
                <li>
                    <b>RowCallbackHandler</b>
                    jdbcTemplate uses RowMapper in methods that doesn't return values. Called for
                    each ResultSet record separately.
                </li>
            </ul>
            <br/>
            Alternative callback interfaces:
            <ul>
                <li>
                    <b>RowMapper</b> called for each ResultSet record separately to convert it to a result object
                </li>
                <li>
                    <b>ResultSetExtractor</b> called once for the whole ResultSet to convert it to a result object
                </li>
            </ul>
        </div>
        <div id="c3_21">
            jdbcTemplate.execute(...) can execute any arbitrary SQL (select, insert, delete...), including DDL statements
            (e.g. CREATE TABLE).<br/>
            Can throw DataAccessException. Returns void.
        </div>
        <div id="c3_3">
            <b>Plain SQL</b> statement execution:
            <ul>
                <li>jdbcTemplate.<b>queryFor</b>Object("select count(*) from p_user", Integer.class);</li>
                <li>jdbcTemplate.queryForInt("select count(*) from p_user");</li>
            </ul>
            <br/>

            <b>Dynamic queries</b> (with returning an entity) are possible with <b>RowMapper</b>.
            <br/>
            If RowMapper is provided following JdbcTemplate methods can be used:
            <ul>
                <li>
                    <b>query()</b>
                </li>
                <li>
                    <b>queryForObject()</b>
                    – returns one object
                </li>
                <li>
                    <b>queryForMap()</b>
                    - returns object as map (column name:value)
                </li>
                <li>
                    <b>queryForList()</b>
                    - returns multiple objects
                </li>
            </ul>
        </div>
        <div id="c3_4">
            <b>update(..)</b> method performs insert, update and delete operations and returns number of affected rows. Can call
            <b class="r">stored procedures</b>.<br/>
            Parameter values are usually provided as Objects varargs leaving them to the PreparedStatement to guess the corresponding SQL field type.
            <br/><br/>
            Samples:
            <ul>
                <li>jdbcTemplate.update("<b>insert into</b> t_actor (first_name, last_name) values (?, ?)", "Leonor", "Watling");</li>
                <li>jdbcTemplate.update("<b>update</b> t_actor <b>set</b> last_name = ? where id = ?", "Banjo", 5276L);</li>
                <li>jdbcTemplate.update("<b>delete</b> from actor where id = ?", Long.valueOf(actorId));</li>
                <li>jdbcTemplate.update("<b>call</b> MY_PROCEDURE(?)", Long.valueOf(unionId));</li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="c4_1">
            A transaction (symbolizes a
            <b>unit of work</b>) is a series of operations such that either all occur, or
            nothing occurs.
            <br/>
            <br/>
            Being cross-cutting concern in Spring is implemented with AOP.
            <br/>
            <br/>

            The Unit of Work pattern is used to group one or more operations into a single
            transaction, so that all operations either pass or fail as one.
            <br/>
            JDBC AutoCommit mode forces to run each query as separate transaction. So
            <b>AutoCommit mode is opposite to
                UnitOfWork</b>.
        </div>
        <div id="c4_2">
            <ul>
                <li>
                    <b>Global transactions</b>
                    handles multiple transactional resources (e.g. databases + message queues).
                    The application server manages global transactions through the JTA (with JNDI source).
                </li>
                <li>
                    <b>Local transactions</b>
                    handles single transactional resources
                </li>
            </ul><br/>
            JTA - Java Transaction API
        </div>
        <div id="c4_3">
            Defined by the <b>PlatformTransactionManager</b> interface with methods
            <ul>
                <li><b>getTransaction</b> (takes TransactionDefinition as an argument and returns TransactionStatus)</li>
                <li><b>commit</b></li>
                <li><b>rollback</b></li>
            </ul><br/>

            <b>TransactionDefinition</b>
            defines transaction properties:
            <ul>
                <li>isolation level</li>
                <li>propagation behavior</li>
                <li>transaction timeout</li>
                <li>read-only status</li>
            </ul>
            <br/>

            <b>TransactionStatus</b> - new or current transaction status with methods:
            <ul>
                <li>isNewTransaction()</li>
                <li>hasSavepoint()</li>
                <li>setRollbackOnly()</li>
                <li>isRollbackOnly()</li>
                <li>flush()</li>
                <li>isCompleted()</li>
            </ul><br/>
            <b class="r">DataSourceTransactionManager</b> is a implementation for single JDBC datasources
        </div>
        <div id="c4_4">
            One of the transaction properties.
            <br/>
            <br/>
            <table>
                <tr>
                    <th>Level</th>
                    <th>Name</th>
                    <th>phantom reads</th>
                    <th>non-repeatable reads</th>
                    <th>dirty reads</th>
                </tr>
                <tr>
                    <td>1st (lowest)</td>
                    <td>Read <b>uncommitted</b></td>
                    <td>&nbsp;&nbsp;allowed</td>
                    <td>&nbsp;&nbsp;allowed</td>
                    <td>&nbsp;&nbsp;allowed</td>
                </tr>
                <tr>
                    <td>2nd*</td>
                    <td>Read <b>committed</b></td>
                    <td>&nbsp;&nbsp;allowed</td>
                    <td>&nbsp;&nbsp;allowed</td>
                    <td></td>
                </tr>
                <tr>
                    <td>3rd</td>
                    <td><b>Repeatable</b> reads</td>
                    <td>&nbsp;&nbsp;allowed</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>4th (highest)</td>
                    <td><b>Serializable</b></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            <br/>
            *default in most DBs<br/><br/>
            <ul>
                <li><b>dirty read</b> [reading uncommitted between transactions] -
                    reading not committed changes between transactions</li>
                <li><b>non-repeatable read</b> [record changes] -
                    second read from transaction can return different record state (if committed by another transaction in parallel)</li>
                <li><b>phantom reads</b> [list changes] -
                    second read from transaction can return different records list (if aded/removed by another transaction)</li>
            </ul>
        </div>
        <div id="c4_5">
            One of the transaction properties.
            <br/>
            Propagation defines behavior of the target methods:
            if they should be executed in an existing or new transaction, or no transaction at all.
            <br/>
            <br/>
            <ul>
                <li><b>REQUIRES_NEW</b>: create a new transaction, suspend any existing one
                </li>
                <li><b>MANDATORY</b>: use current transaction, throw exception if none exists
                </li>
                <li><b class="r">[DEFAULT]</b> <b>REQUIRED</b>: use current transaction, if non exists – create one
                </li>
                <li><b>SUPPORTS</b>: use current transaction, execute non-transactionally if none exists
                </li>
                <li><b>NEVER</b>: execute non-transactionally, throw exception if any transaction exists
                </li>
                <li><b>NOT_SUPPORTED</b>: execute non-transactionally, suspend any existing transaction
                </li>
                <li>
                    <b>NESTED</b>: if a transaction exists create a nested one in it and execute everything there, else
                    behave like Propagation.REQUIRED
                </li>
            </ul>
        </div>
        <div id="c4_6">
            <ul>
                <li><b>Declarative</b>: best for big amount of transactional operations.
                    <br/>
                    Configuration:
                    <ul>
                        <li>
                            <b class="r">@EnableTransactionManagement</b> or <b class="r">&lt;tx:annotation-driven/></b>
                            to configuration
                        </li>
                        <li>
                            <b>@Transactional</b> annotation on methods/classes
                        </li>
                    </ul>
                    Transactional AOP proxy uses a <b>TransactionInterceptor</b> in conjunction with an appropriate
                    PlatformTransactionManager implementation to drive transactions around method invocations.
                    Used in its AOP proxies in applying transactional advice.
                </li>
                <li>
                    <b>Programming</b>: best for small number of transactional operations. Can set transaction name.
                    <br/>
                    Can be configured in two ways:
                    <ul>
                        <li>use
                            <b>PlatformTransactionManager</b>
                            bean directly to <b class="r">initiate</b>, <b class="r">roll back</b>, and <b class="r">commit</b>
                            transactions (using the TransactionDefinition and TransactionStatus)
                        </li>
                        <li>create <b>TransactionTemplate</b> and call execute(TransactionCallback)
                        </li>
                    </ul>
                </li>
            </ul><br/>
            Main entities:
            <ul>
                <li><b>TransactionTemplate</b> - simplifies programmatic <b class="r">transaction demarcation</b>
                    and <b class="r">transaction exception handling</b></li>
                <li><b>PlatformTransactionManager</b> - is the central interface in Spring's transaction infrastructure. Applications
                    can use this directly, but it is not primarily meant as API: Typically, applications will work with
                    either TransactionTemplate or declarative transaction demarcation through AOP.</li>
            </ul>
        </div>
        <div id="c4_7">
            @Transactional forces <b>AnnotationTransactionAspect</b> to interpret target method as a <b>join point</b>.
            Method or class marked @Transactional will be covered in transactional behavior
            (when method starts transaction will be opened and closed when the method finished).
            <br/>
            <br/>
            <b>Important</b>:
            <ul>
                <li>@Transactional can be applied on interface methods only if JDK dynamic proxy is used</li>
                <li>By default @Transactional works only on public methods. Using it on non-public methods will not raise any error,
                    but will have no transactional behaviour. @Transactional will work on non-public methods only in <b>AspectJ mode</b>.</li>
                <li>If one @Transactional method is calling another on the same object instance:
                    since transaction-management is implemented using AOP - @Transactional annotation will have no effect
                    on the method being called as no proxy is created. The same behavior is characteristic for AOP aspects.</li>
            </ul>

        </div>
        <div id="c4_8">
            Rollback policy - in case of occured <b>RuntimeException</b> or <b class="r">Errors</b> transaction is
            <b>marked for rollback</b>.
            <br/><br/>
            Types ot Exceptions for rollback can be changed (including checked exceptions):
            <ul>
                <li>XML: '<b>rollback-for</b>' or '<b>no-rollback-for</b>' attributes can be added to tx:method</li>
                <li>TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();</li>
                <li>By @Transactional parameters: <b>rollbackFor</b>, <b>noRollbackFor</b>, <b>rollbackForClassName</b>,
                    <b>noRollbackForClassName</b>
                </li>
            </ul>
            <br/>

            <b>@Transactional test is automatically rolled back</b>
            after completion when:
            <ul>
                <li>used @RunWith(SpringJUnit4ClassRunner.class) in JUnit 4</li>
                <li>used @ExtendWith(SpringExtension.class) in JUnit 5</li>
            </ul>
        </div>
        <div id="c4_9">

        </div>
    </div>

    <div class="hidden">
        <div id="c6_1">
            <b>Object Relational Mapping</b>
            is meant to help us map our entities to the database tables.
            <br/>
            <br/>
            Benefits
            <ul>
                <li>Easy mapping object model to data model</li>
                <li>Much less code</li>
                <li>Concurrency support</li>
                <li>Automatic management of: Cache, Connection pool, Transactions, Keys</li>
            </ul>
            <br/>

            Disadvantages
            <ul>
                <li>Overhead for simple applications</li>
                <li>Need to learn implementation</li>
                <li>Performance lower</li>
                <li>Hard to make complex queries</li>
            </ul>
        </div>
        <div id="c6_2">
            Approaches to manipulate entities:
            <ul>
                <li><b>@PersistenceContext</b> (preferable)
                    <ul>
                        <li>defines dependency on a container-managed <b>EntityManager</b> and its associated persistence context</li>
                    </ul>
                </li>
                <li><b>@PersistenceUnit</b>
                    <ul>
                        <li>defines dependency to <b>EntityManagerFactory</b> and its associated persistence unit</li>
                        <li>EntityManagerFactory allows to create/destroy <b>EntityManager</b> manually</li>
                    </ul>
                </li>
            </ul><br/>

            <b>EntityManager</b>
            <ul>
                <li>associated with a persistence context (field in extended classes)</li>
                <li>inherited persistance context contains a set of entity instances that correspond to persistent entity identity</li>
                <li>writes, deletes and searches @Entity(s) to database</li>
            </ul><br/>

            <b>@Entity</b> marks a class as an entity that will be mapped to the database using ORM
        </div>
    </div>

    <div class="hidden">
        <div id="c7_1">
            <b>Java Persistence API</b> - high level <b>API and specification</b> so that different ORM tools can implement so that it
            provides the flexibility to developer to change the implementation from one ORM to another
        </div>
        <div id="c7_2">
            One of EntityManagerFactorys need to be configured:
            <ul>
                <li>
                    <b>LocalContainerEntityManagerFactoryBean</b>: supports injection of DataSource, local and global
                    transactions
                </li>
                <li>
                    <b>LocalEntityManagerFactoryBean</b>: suitable only for simple development purposes. "persistence
                    unit" with provider and properties (persistence.xml or more programmically since Spring 3.1).
                </li>
            </ul><br/>
            Alternative is to use in a JEE-compliant container where <b>application server</b> bootstraps the JPA
            persistence unit based on the information in the deployment descriptors. This allows Spring to look up
            the entity manager via <b>JNDI lookup</b>. In the JPA specification, a persistence unit should be defined in the
            configuration file META-INF/ persistence.xml or just using "Entity Scanning" since Spring 3.1
            <br/><br/>

            <b class="r">JpaTransactionManager</b> is an implementation of PlatformTransactionManager for a single JPA EntityManagerFactory.
            It binds a JPA EntityManager from the mentioned factory to the thread. Select the one that applies best.
            <br/><br/>

            Configuring JPA In Spring Boot:
            <ul>
                <li>spring-boot-starter</li>
                <li><b>spring-boot-starter-data-jpa</b></li>
            </ul>
        </div>
        <div id="c7_3">
            JpaTransactionManager expose a JPA transaction to JDBC access code that accesses the same DataSource
        </div>
    </div>

    <div class="hidden">
        <div id="c8_1">
            Is a simple way to create repoeitories.
            <br/>
            Can be done in two ways:
            <ul>
                <li>extend repository interface with <b>Repository</b>, <b>CrudRepository</b> or
                    <b>PagingAndSortingRepository</b>
                </li>
                <li>annotate your repository interface with
                    <b class="r">@RepositoryDefinition</b>
                </li>
            </ul><br/><br/>
            <b>JDK Proxy</b> will be used when Spring Data repositories are implemented at runtime.
        </div>
        <div id="c8_2">
            The query builder mechanism built into Spring Data repository infrastructure is building
            constraining queries over entities of the repository.
            <br/>
            The mechanism strips the following prefixes from the method and starts parsing the rest of it
            <ul>
                <li>
                    <b>find…By</b>
                </li>
                <li>
                    <b>read…By</b>
                </li>
                <li>
                    <b>query…By</b>
                </li>
                <li>
                    <b>count…By</b>
                </li>
                <li>
                    <b>get…By</b>
                </li>
            </ul>
        </div>
        <div id="c8_3">
            For more <b>complex queries</b>, you can annotate your method with <b>@Query</b>.
            <br/><br/>
            Features:
            <ul>
                <li>Allows customization using SQL/JPQL</li>
                <li>The execution of <b>pagination</b> or <b>dynamic sorting</b> for native queries is <b class="r">not supported</b></li>
                <li>Queries annotated to the query method will <b class="r">take precedence</b> over queries defined using
                    <b>@NamedQuery</b> or named queries declared in <b>orm.xml</b></li>
                <li>has <b>nativeQuery</b> parameter that allows usage of native queries</li>
            </ul>
        </div>
    </div>
</div>
<div>
    <h4>Spring Boot</h4>
    <ul>
        <li>
            <b class="sub">Spring Boot:</b>
            <a title="d1_0" class="label-danger">running</a>
            <a title="d1_1">what is</a>
            <a title="d1_11">ext Config</a>
            <a title="d1_2">advantages</a>
            <a title="d1_3">configuration</a>
            <a title="d1_4" class="label-warning">properties</a>
            <a title="d1_5">embadded containers</a>
            <a title="d1_6">starter POM</a>
            <a title="d1_7">logging</a>
            <a title="d1_8">json</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="d1_0">
            SpringApplication can be run in following ways:
            <ul>
                <li>SpringApplication.<b>run(WsApplication.class)</b>;</li>
                <li>SpringApplication.<b>run(WsApplication.class, args)</b>;</li>
                <li><b>new</b> SpringApplication(WsApplication.class).<b>run(args)</b>;</li>
                <li><b>new</b> SpringApplication(WsApplication.class).<b>run()</b>;</li>
            </ul>
        </div>
        <div id="d1_1">
            Spring Boot is an extension of the Spring framework which eliminates the boilerplate configurations
            required for setting up a Spring application.

            <br/><br/>
            Features:
            <ul>
                <li>Create <b>stand-alone</b> Spring applications
                </li>
                <li>
                    <b>Embed servlet containers</b> (no need to deploy WAR files)
                </li>
                <li>Provide
                    <b>opinionated*</b> 'starter' dependencies to simplify your build configuration
                </li>
                <li>
                    <b>Automatically configure</b> Spring and 3rd party libraries whenever possible
                </li>
                <li>Provide production-ready features such as metrics, health checks and externalized configuration</li>
                <li>Absolutely no code generation and no requirement for XML configuration</li>
            </ul>
            <br/>
            * <b>Opinionated</b>: Spring scans dependencies from classpath and adds support for different
            components by initializing “maybe” required beans. For example if it sees a dependency on Thymeleaf,
            3 beans that Thymeleaf uses are automatically initialized: ThymeleafViewResolver, SpringTemplateEngine,
            TemplateResolver. Moreover it also scans the templates directory from resources for Thymeleaf templates.
            If you have tomcat-embedded.jar on your classpath TomcatServletWebServerFactory bean will be initialized.
            <br/><br/>
            Spring Bood <b class="r">does not</b> do code generation.
        </div>
        <div id="d1_11">
            Spring Boot lets you externalize your configuration so that you can work with the same application code
            in different environments.<br/><br/>
            Can be done in:
            <ul>
                <li>properties files</li>
                <li>YAML files</li>
                <li>environment variables</li>
                <li>command-line arguments</li>
            </ul>
        </div>
        <div id="d1_2">
            <ul>
                <li>easy configuration of Spring application</li>
                <li>Integrated web containers that allow for easy testing</li>
                <li>Starters – sets of dependencies that help setting up a “typical” application</li>
                <li>Decrease amount of boilerplate code</li>
            </ul>
        </div>
        <div id="d1_3">
            <b>@EnableAutoConfiguration</b>
            - enables auto-configuration of the Application Context (opinionated view)
            <br/>
            <br/>

            <b>@SpringBootApplication</b>
            - just convenient annotation that is
            meta-annotated with @Configuration, @EnableAutoConfiguration and @ComponentScan.
        </div>
        <div id="d1_4">
            common annotations and configuration properties
            SpringApplication loads properties from <b>application.properties</b> (or
            <b>yml/yaml</b>) files in the
            following locations and adds them to the Spring Environment:
            <ul>
                <li>
                    <b>current directory /config</b>
                </li>
                <li>
                    <b>current directory</b>
                </li>
                <li>
                    <b>classpath /config</b>
                </li>
                <li>
                    <b>classpath root</b>
                </li>
            </ul><br/>
            <b class="r">@ConfigurationProperties</b> - externalized properties configuration
        </div>
        <div id="d1_5">
            Spring Boot supports following embedded containers:
            <ul>
                <li>
                    <b>Tomcat</b>
                </li>
                <li>
                    <b>Jetty</b>
                </li>
                <li>
                    <b>Undertow</b>
                </li>
            </ul>
            <br/>

            Jar vs War
            <ul>
                <li>JAR - onlly suitable for embedded container since it will come as a part of the application</li>
                <li>WAR - archive that can be deployed on an external container</li>
            </ul><br/>

            To build <b>WAR</b> you need:
            <ul>
                <li>&lt;packaging>war&lt;/packaging></li>
                <li>Make spring-boot-starter-tomcat dependency as provided to avoid server files being included in the war</li>
                <li>provide SpringBootServletInitializer implementation</li>
            </ul>
        </div>
        <div id="d1_6">
            Maven users can inherit from the
            <b>spring-boot-starter-parent</b>
            project to obtain sensible defaults.
            <br/>
            <br/>
            Features:
            <ul>
                <li>
                    <b>Java 1.8</b>
                    as the default
                </li>
                <li>
                    <b>UTF-8</b>
                    source encoding
                </li>
                <li>A Dependency Management section, inherited from the spring-boot-dependencies pom, that manages
                    the
                    <b>versions of common dependencies</b>. This dependency management lets you omit
                    &lt;version>
                    tags for those
                    dependencies when used in your own pom.
                </li>
                <li>Pom properties can be used in project properties (or yml) using
                    <b>@..@</b>
                    placeholders
                </li>
                <li>Additional <b>plugin configurations</b> (exec plugin, Git commit ID, and shade)
                </li>
                <li>
                    <b>profile-specific resource filtering</b>
                    (e.g. application-dev.properties and application-dev.yml)
                </li>
            </ul>
        </div>
        <div id="d1_7">
            Configuration:
            <ul>
                <li>add the required dependencies to the classpath</li>
                <li>configure the required framework using:
                    <ul>
                        <li>application.properties</li>
                        <li>framework-specific configuration file placed in the classpath</li>
                        <li>system properties</li>
                    </ul>
                </li>
            </ul>
            <br/>
            Spring Boot uses <b class="r">Commons Logging</b>
            for all internal logging but leaves the underlying log implementation open.
            <br/>
            <br/>
            Default configurations are provided for;
            <ul>
                <li><b>Java Util Logging</b></li>
                <li><b>Log4J2</b></li>
                <li><b>Logback</b></li>
            </ul>
        </div>
        <div id="d1_8">
            <b>JsonComponent</b> - Component that provides JsonSerializer and/or JsonDeserializer implementations to be
            registered with Jackson when JsonComponentModule is in use. Can be used to annotate JsonSerializer or
            JsonDeserializer implementations directly or a class that contains them as inner-classes.
        </div>
    </div>
</div>
<div>
    <h4>Spring MVC</h4>
    <ul>
        <li>
            <b class="sub">Overview:</b>
            <a title="e1_1">what is</a>
            <a title="e1_2" class="label-warning">configuration</a>
            <a title="e1_3">components</a>
            <a title="e1_5" class="label-danger">MessageSource</a>
            <a title="e1_6" class="label-warning">web.xml</a>
        </li>
        <li>
            <b class="sub">Controller:</b>
            <a title="e2_1">@Controller</a>
            <a title="e2_2">request mapping</a>
            <a title="e2_3" class="label-warning">parameters</a>
            <a title="e2_4">return types</a>
            <a title="e2_5">testing</a>
            <a title="e2_6" class="label-danger">no annotations</a>
        </li>
        <li>
            <b class="sub">View:</b>
            <a title="e3_1">overview</a>
            <a title="e3_2">resolvers</a>
        </li>
        <li>
            <b class="sub">Model:</b>
            <a title="e4_1">overview</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="e1_1">
            <b>Spring Web MVC</b> is the original web framework built on the Servlet API and has been included in the
            Spring Framework from the very beginning. The formal name, “Spring Web MVC,” comes from the name of
            its source module (spring-webmvc), but it is more commonly known as “Spring MVC”.
            <br/><br/>
            MVC is an abbreviation for a
            <b>Model–View–Controller</b>
            pattern that decouples major components
            allowing for efficient code reuse and parallel development.
        </div>
        <div id="e1_2">
            <ul>
                <li>Add <b>spring-webmvc.jar</b> to classpath (it's not part of spring-core)
                </li>
                <li>Add <b>@EnableWebMvc</b> to @Configuration (in Spring Boot not needed)
                </li>
                <li>
                    <b>Register DispatcherServlet</b>
                    in one of two ways:
                    <ul>
                        <li>implement WebApplicationInitializer</li>
                        <li>extend AbstractAnnotationConfigDispatcherServletInitializer</li>
                    </ul>
                </li>
                <li>Register <b>ContextLoaderListener</b> in web.xml. Inside &lt;listener> -> <b>&lt;listener-class></b><br/>
                    ContextLoaderListener is responsible for starting up and shutting down Spring's root WebApplicationContext
                </li>
            </ul>
        </div>
        <div id="e1_3">
            <b>DispatcherServlet</b>
            - front controller that provides a shared algorithm for
            request processing, while actual work is performed by configurable delegate controllers.
            DispatcherServlet initializes WebApplicationContext (child of root ApplicationContext).
            <br/>
            <br/>

            <b>WebApplicationContext</b>
            is an interface to provide configuration for a web application. Typically
            contains infrastructure beans, such as data repositories and business services that need to be shared across
            multiple Servlet instances. Supports additional scopes: <b>request</b>, <b>session</b>, <b>application</b>
            <br/><br/>
            <b>AnnotationConfigWebApplicationContext</b> is an implementation of <b>WebApplicationContext</b> that is
            essentially the equivalent of AnnotationConfigApplicationContext for a web environment. Can be configured in
            Java config as well as in XML.
            <br/><br/>
            <b>contextConfigLocation</b> param can be set to DispatcherServlet in web.xml to set @Configuration class or xml config.
        </div>
        <div id="e1_5">
            <b>MessageSource</b> (interface) - a solution to make a management of static text more easier and efficient.<br/>
            <b>ResourceBundleMessageSource</b> (implementation of MessageSource) can get messages from the defined property file.<br/><br/>
            Further usage of ubtained messages in the JSP:<br/>
            <b>&lt;spring:message code="page.header"/></b><br/>
            where "page.header" is a property name whit will be substituted by it's value.<br/><br/>

            MessageSource interface is <b>automatically resolved</b>, with no additional setup necessary, other than putting
            the 'Autowired' annotation.
        </div>
        <div id="e1_6">
            In web.xml you can declare:
            <ul>
                <li><b>AnnotationConfigWebApplicationContext</b> (declare the root application context)</li>
                <li><b>ContextLoaderListener</b> (bootstraps the root application context)</li>
                <li>Spring configuration class/xml (via "init-param" -> "param-value" -> MyConfig)</li>
                <li>DispatcherServlet</li>
                <li>DelegatingFilterProxy/FilterChainProxy</li>
                <li>servlet-mapping to map all requests to the dispatcher servlet</li>
            </ul><br/>
            You cannot define resolvers since they are must be refistered as a beans.
        </div>
    </div>

    <div class="hidden">
        <div id="e2_1">
            <b>@Controller</b>
            - simply @Component specialization that tells the developer that the component is a
            "Controller" role.

        </div>
        <div id="e2_2">
            <b>@RequestMapping</b>
            maps incoming request to a controller or a method. Supported through a
            RequestMappingHandlerMapping and RequestMappingHandlerAdapter.
            <br/>
            <br/>
            Specializations (can be applied only to method):
            <ul>
                <li>
                    <b>GetMapping</b>
                </li>
                <li>
                    <b>PostMapping</b>
                </li>
                <li>DeleteMapping</li>
                <li>PutMapping</li>
                <li>(and more)</li>
            </ul>
            <br/>
        </div>
        <div id="e2_3">
            Mappling parameters:
            <ul>
                <li>
                    <b class="r">@PathVariable</b>
                    maps method parameters from the URI path(e.g. http://foo.com/user<b>/33</b>)
                </li>
                <li>
                    <b class="r">@RequestParam</b>
                    maps method parameters from the URI query (e.g.
                    http://foo.com/user<b>?id=33</b>).
                    <br/>
                    <ul>
                        <li>For Map/MultiValueMap - populated with all request parameters</li>
                        <li>MultipartFile - representation of an uploaded file</li>
                    </ul>
                </li>
                <li>@MatrixVariable</li>
                <li>@RequestPart</li>
                <li><b class="r">@RequestHeader</b></li>
                <li>@CookieValue</li>
                <li><b class="r">@ModelAttribute</b></li>
                <li>@SessionAttribute</li>
            </ul>
            <br/>
            All of the above except ModelAttribute are <b class="r">Required</b> by default.
            <br/><br/>

            Controller method can receive following arguments (without any annotation):
            <ul>
                <li><b class="r">ServletRequest</b></li>
                <li><b class="r">ServletResponse</b></li>
                <li><b class="r">HttpSession</b></li>
                <li>Principal</li>
                <li>HttpMethod</li>
                <li>Map</li>
                <li>Model</li>
                <li>ModelMap</li>
                <li>Any other type with converter</li>
            </ul>
        </div>
        <div id="e2_4">
            <ul>
                <li>void</li>
                <li>String - returns logical view name</li>
                <li>View</li>
                <li>HttpHeaders</li>
                <li>Map</li>
                <li>Model</li>
                <li>ModelAndView</li>
                <li>(and more)</li>
            </ul>
        </div>
        <div id="e2_5">
            <ul>
                <li>
                    <b>Mock</b>
                    implementations of Servlet API contracts for unit testing
                    <b>controllers</b>,
                    filters, and other web components
                </li>
                <li>A framework, also known as
                    <b>MockMvc</b>, for testing annotated controllers through the DispatcherServlet
                </li>
            </ul>
        </div>
        <div id="e2_6">
            To create a controller without annotations:
            <ul>
                <li>Create an implementation of <b>Controller</b> interface or extension of
                    any Controller's implementations like AbstractController.</li>
                <li>A <b class="r">HandlerMapping</b> implementation that does not use annotations can be used, to map the requests
                    to the handler objects.</li>
                <li>BeanNameUrlHandlerMapping is included in the Spring framework, and it is the default if no
                    HandlerMapping bean is registered in the application context.</li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="e3_1">
            View is the base interface for different view technologies (XML, PDF, XLS etc.).
            <br/>
            All handler methods in the Spring MVC controllers must resolve to a
            <b class="r">logical view name</b>, either explicitly
            (e.g., by returning a String, View, or ModelAndView) or implicitly (i.e., based on conventions)
            <br/>
            Views in Spring are addressed by a logical view name and are resolved by a
            <b>view resolver</b>.
        </div>
        <div id="e3_2">
            The right view is chosen by the
            <b>ViewResolver</b>
            bean that has to be registered in the container.
            <ul>
                <li>The DispatcherServlet delegates to a ViewResolver to obtain View implementation based on view
                    name.
                </li>
                <li>The default ViewResolver treats the view name as a Web Application-relative file path – i.e. a JSP:
                    /WEB-INF/reward/list.jsp
                </li>
                <li>Override this default by registering a ViewResolver bean with the DispatcherServlet</li>
            </ul>
            <br/>

            Some of View Resolvers in Spring MVC:
            <ul>
                <li>Thymeleaf: ThymeleafViewResolver</li>
                <li>JSP and JSTL: <b class="r">InternalResourceViewResolver</b> or <b class="r">ResourceBundleViewResolver</b></li>
                <li>Apache Tiles: <b class="r">UrlBasedViewResolver</b> or ResourceBundleViewResolver</li>
                <li>Xslt: XsltViewResolver</li>
            </ul><br/>

            Other resolvers:
            <ul>
                <li><b>HandlerExceptionResolver</b>:  maps exceptions to views also allowing for more complex exception handling code.</li>
                <li><b>ThemeResolver</b>:  resolves themes your web application can use, for example, to offer personalized layouts</li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="e4_1">
            <b>Model</b>
            in Spring MVC represents processed data to be rendered in the view by the respective view resolver.
            Is an object backed my a
            <b>Map of attributes</b>
            names and values that can be sent between client and server.
            <br/>
            <br/>

            Processing:
            <ul>
                <li>Model is passed by the controller to the dispatcher servlet</li>
                <li>dispatcher server send it to the respective view resolver</li>
                <li>view resolver is rendering model’s data to the view and generate html page</li>
            </ul>
            Spring provide support to access the model in the view layer
        </div>
    </div>
</div>
<div>
    <h4>Security</h4>
    <ul>
        <li>
            <b class="sub">Overview:</b>
            <a title="f1_1">overview</a>
            <a title="f1_11">principal</a>
            <a title="f1_2">authentication vs authorization</a>
            <a title="f1_3" class="label-warning">method security</a>
            <a title="f1_4">view protection</a>
        </li>
        <li>
            <b class="sub">Configuration:</b>
            <a title="f2_1" class="label-danger">filters</a>
            <a title="f2_3">context</a>
            <a title="f2_4">intercept-url</a>
            <a title="f2_5">antMatcher vs mvcMatcher</a>
            <a title="f2_6" class="label-warning">passwords</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="f1_1">
            Spring Security is a cross cutting concern.
            implemented in the following two ways depending on what is to be secured:
            <ul>
                <li><b>Method invocation authorization</b>: is done via AOP proxy
                    that inherits from the AbstractSecurityInterceptor class.
                </li>
                <li><b>Web infrastructure security</b>: is based entirely on servlet filters.
                    It deals in <b class="r">HttpServletRequest</b> s and <b class="r">HttpServletResponse</b>. Spring Security maintains a filter chain
                    internally where each of the filters has a particular responsibility.
                </li>
            </ul><br/>

            Spring Security offers several options for configuring a user store:
            <ul>
                <li>An <b>in-memory</b> user store</li>
                <li>A <b>JDBC-based</b> user store</li>
                <li>An <b>LDAP</b>-backed user store</li>
                <li>A custom user details service</li>
            </ul><br/>

            Aauthentication integrasion is supported with technologies:
            <ul>
                <li>HTTP: BASIC, Digest, X.509</li>
                <li>LDAP</li>
                <li>Automatic "remember-me" and Anonymous</li>
                <li>JAAS</li>
                <li>Java EE container auth</li>
                <li>Kerberos</li>
                <li>and many-many more</li>
            </ul>
        </div>
        <div id="f1_11">
            Main emtities:
            <ul>
                <li><b>UserDetails</b>, <b>User</b> - represents principal. Store sensitive user information. Encapsulated into Authentication objects</li>
                <li><b>UserDetailsService</b> - core DAO interface which loads user-specific data. Return User objects.</li>
                <li><b>Authentication</b> - a token for an authentication request or for an authenticated
                    principal once the request has been processed</li>
                <li><b>SecurityContext</b> - thread-local storage for the Authentication</li>
                <li><b>SecurityContextHolder</b> - manages SecurityContext by some authentication mechanism</li>
            </ul><br/>
            <b>Note</b>: It is possible to store UserDetails in <b>LDAP/DB and other.</b>.
        </div>
        <div id="f1_2">
            <ul>
                <li>
                    <b>Authentication</b>
                    is the process of identifying whether this user exists (come first)
                </li>
                <li>
                    <b>Authorization</b>
                    is the process of determining what it may or may not do (roles, permissions)
                </li>
            </ul>
        </div>
        <div id="f1_3">
            Method-level security is commonly applied to services in the service layer of an application. Implemented by
            AOP Proxies.<br/><br/>
            Approaches:
            <ul>
                <li>
                    <b>@PreAuthorize, @PostAuthorize, @PreFilter, @PostFilter</b>
                    <ul>
                        <li>use SpEL expression</li>
                        <li>enabled by
                            <ul>
                                <li>@EnableGlobalMethodSecurity(<b class="r">prePostEnabled</b>=true)</li>
                                <li>&lt;global-method-security <b>pre-post-annotations</b>="enabled" /></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <b>@RolesAllowed</b>
                    <ul>
                        <li>restricted by role name</li>
                        <li>enabled by
                            <ul>
                                <li>@EnableGlobalMethodSecurity(<b class="r">jsr250Enabled</b>=true)</li>
                                <li>&lt;global-method-security <b>jsr250-annotations</b>="enabled" /></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <b>@Secured</b>
                    <ul>
                        <li>legacy annotation - better to use @PreAuthorize instead</li>
                        <li>restricted by role name</li>
                        <li>enabled by
                            <ul>
                                <li>@EnableGlobalMethodSecurity(<b class="r">securedEnabled</b>=true)</li>
                                <li>&lt;global-method-security <b>secured-annotations</b>="enabled" /></li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul><br/>
            *annotations can be applied to class or method levels
        </div>
        <div id="f1_4">
            In order to protect JSP elements Spring <b>Security taglib</b> have to be used.
            <br/>
            <br/>


            Examples:
            <ul>
                <li>
                    <b>declaring</b>
                    <br/>
                    &lt;%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>
                </li>
                <li>
                    <b class="r">authorize</b>
                    tag: visibility by condition
                    <br/>
                    &lt;sec:authorize access="hasRole('aadministrator')">Admin!&lt;/sec:authorize>
                </li>
                <li>
                    <b class="r">authentication</b>
                    tag: allows for accessing the Authentication object in the current security
                    context
                    <br/>
                    &lt;sec:authentication property="principal.username"/>
                </li>
                <li>
                    <b class="r">accesscontrollist</b>
                    tag (deprecated, use authorize tag): checks a list of permissions for a specific
                    domain object
                    <br/>
                    &lt;sec:accesscontrollist hasPermission="5, 7" domainObject="${order}">
                </li>
                <li>when cross-site request forgery (CSRF) protection is enabled
                    <ul>
                        <li>
                            <b>csrfInput</b>
                            tag inserts a hidden form with the name and value of the CSRF protection token
                            in the rendered page
                            <br/>
                            &lt;form action="login" method="post">
                            &lt;sec:csrfInput/>// fields //
                            &lt;/form>
                        </li>
                        <li>
                            <b>csrfMetaTags</b>
                            tag inserts meta tags containing the CSRF protection token form field and header
                            names and CSRF protection token value. These meta tags can then be accessed from JavaScript
                            in your application.
                            <br/>
                            &lt;sec:csrfMetaTags/>
                            &lt;script>
                            var csrfToken = $("meta[name='_csrf']").attr("content");
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="f2_1">
            <b>DelegatingFilterProxy</b>
            <ul>
                <li>implements the javax.servlet.Filter interface and thus is a <b>servlet filter</b></li>
                <li>registered in the web.xml as a &lt;filter> and linked in &lt;filter-mapping> by filter-name for particular &lt;url-pattern></li>
                <li>provides the link between web.xml and the application context</li>
            </ul><br/>

            <b>FilterChainProxy</b>
            <ul>
               <li>more comfortable and readable alternative to DelegatingFilterProxy</li>
               <li>can be used instead of adding separate DelegatingFilterProxy for each filter</li>
               <li>registered in the web.xml as a &lt;bean> and linked in &lt;filter-mapping> by filter-name for particular &lt;url-pattern></li>
               <li>defines a list of SecurityFilterChain</li>
            </ul>
            <br/>

            <b>SecurityFilterChain</b>
            <ul>
                <li>Contains list of Filters</li>
                <li><b>DefaultSecurityFilterChain</b> - the only Spring implementation</li>
            </ul><br/><br/>

            <b>Filters ordering</b>:
            <ul>
                <li>first filter is <b class="r">ChannelProcessingFilter</b></li>
                <li>huge list of other filters...</li>
                <li>last (almost) - <b class="r">FilterSecurityInterceptor</b></li>
            </ul>
        </div>
        <div id="f2_3">
            <b>SecurityContext</b>
            interface, which defines the minimum security information associated with a thread of
            execution.
            <br/>
            <br/>
            There are two methods:
            <ul>
                <li>setting an object that implements the Authentication</li>
                <li>retrieving an object that implements the Authentication</li>
            </ul><br/>
            The <b>Authentication</b> interface defines the properties of an object that represents a
            <b>security token</b>
            for <b>authentication request</b> (prior to authentication) and
            <b>authenticated principal</b>
            (after
            authentication).
        </div>
        <div id="f2_4">
            The
            &lt;<b>intercept-url</b>> element specifies WHO will be able to access whit URL resources
            <br/>
            <br/>
            Attributes:
            <ul>
                <li>
                    <b class="r">access</b>: Access attributes, commonly role names, specifying the user(s) that has access
                </li>
                <li>
                    <b class="r">filters</b>: Omitted or having the value “<b class="r">none</b>” (filter chain for the
                    URL pattern entirely ignored and all requests are alowed)
                </li>
                <li>
                    <b class="r">method</b>: HTTP method used with URL pattern and, optionally, servlet path to match requests.
                    If omitted all HTTP methods will match.
                </li>
                <li>
                    <b class="r">pattern</b>: URL path pattern for which the Spring Security filter chain will be applied.
                </li>
                <li>
                    <b>request-matcher-ref</b>: Reference to RequestMatcher bean used to determine if this
                    intercept-url will be used.
                </li>
                <li>
                    <b class="r">requires-channel</b>: “http”, “https” or “any”.
                </li>
                <li>
                    <b>servlet-path</b>: Servlet path used in combination with method and pattern to match requests.
                </li>
            </ul>
            <br/>
            <b>Multiple intercept-url</b>
            elements may be defined and they will be evaluated in the order in which they are
            defined.
            When an intercept-url element with a matching pattern is found, evaluation stops.
            It is therefore recommended to define more intercept-url elements with more specific pattern earlier and
            more
            general patterns later.
        </div>
        <div id="f2_5">
            antMatchers vs mvcMatchers:
            <ul>
                <li><b>antMatchers</b>("/services") only matches the exact “/services” URL
                    <ul>
                        <li>only matches the exact URLs. E.g. "/services" matches only "/services"</li>
                        <li>Sample: " .antMatchers("/user/edit").<b class="r">hasRole</b>("ADMIN") "</li>
                    </ul>
                </li>
                <li>
                    <b>mvcMatchers</b>
                    <ul>
                        <li>Matches URLs by the same rules as @RequestMapping. E.g. "/services" matches
                            “/services”, “/services/”, “/services.html” and “/services.abc”
                        </li>
                        <li>mvcMatchers API is newer than the antMatchers API</li>
                    </ul>
                </li><br/>
                Both methods are called from: http.<b class="r">authorizeRequests()</b>.
            </ul>
            <br/>
            * and ** patterns:
            <ul>
                <li>
                    <b>*</b>
                    Matches any path on the level at which the wildcard occur.
                    Example: /services/* matches /services/users and /services/orders but not
                    /services/orders/123/items.
                </li>
                <li>
                    <b>**</b>
                    Matches any path on the level at the wildcard occurs and all levels below.
                    If only /** or ** then will match any request. Example: /services/** matches /services, /services/,
                    /services/users and /services/orders and also /services/orders/123/items etc.
                </li>
            </ul>
        </div>
        <div id="f2_6">
            Spring Security's <b class="r">PasswordEncoder</b> helps in working with encoded passwords (two methods: encode and matches)<br/><br/>
            <b>Hashing</b>
            process is referred to as password encoding and is implemented using the PasswordEncoder
            interface.
            <br/>
            <br/>
            <b>Salt</b>
            is used as additional input for hashing password. Salts are used to safeguard passwords in storage.
        </div>
    </div>
</div>
<div>
    <h4>REST</h4>
    <ul>
        <li>
            <b class="sub">Overview:</b>
            <a title="g1_1">What is</a>
            <a title="g1_2">resources</a>
            <a title="g1_3" class="label-warning">idempotency</a>
            <a title="g1_4">scalable / interoperable</a>
            <a title="g1_5">status codes</a>
            <a title="g1_6" class="label-warning">exceptions</a>
        </li>
        <li>
            <b class="sub">In Spring:</b>
            <a title="g2_1">configuration</a>
            <a title="g2_2">@ResponseStatus</a>
            <a title="g2_3">@SessionAttributes</a>
        </li>
        <li>
            <b class="sub">RestTemplate:</b>
            <a title="g3_1">overview</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="g1_1">
            <b>Representational State Transfer</b>
            (REST) is a software architectural style that defines a set of
            constraints to be used for creating Web services. RESTful Web services allow the requesting systems to
            access and manipulate textual representations of Web resources by using a uniform and predefined set of
            stateless operations.
            <br/>
            <br/>
            REST is <b>stateless</b> because according to its definition it HAS to be stateless; meaning each request
            must
            contain all the required information to interact with the server without the server need to store some
            context
            between requests.
            <br/>
            <br/>

            <b>CRUD</b>
            stands for create, read, update, delete
            <br/>
            <br/>
            REST <b>does not provide any security</b> constraints by default but we can implement it in the RESTful web
            services by using security layers like transport layer security (TLS), auth token security.
            <br/>
            <br/>

            <b>Operations (HTTP methods)</b>
            <ul>
                <li>
                    <b class="r">Safe</b> operations
                    <ul>
                        <li>HEAD</li>
                        <li>GET</li>
                        <li>OPTIONS</li>
                        <li>TRACE</li>
                    </ul>
                </li>
                <li>Operations that
                    <b>might cause side effects</b>
                    <ul>
                        <li>POST</li>
                        <li>PUT</li>
                        <li>DELETE</li>
                        <li>PATCH</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="g1_2">
            <b>Resource</b>:
            <ul>
                <li>Resource a key abstraction of information in REST</li>
                <li>Any information that can be named can be a resource like Student, Employee etc.</li>
                <li>REST is resource based API</li>
                <li>Expose resources through URIs like
                    http://host:80/api/employees/1111, It is based on Model nouns, not verbs
                </li>
                <li>Resources support
                    limited set of operations – GET, PUT, POST, DELETE in case of HTTP. Example: update an employee use
                    PUT to /employees/1111 and don’t POST
                </li>
                <li>Resources can support multiple
                    representations like HTML, XML, JSON etc.
                </li>
                <li>Multiple URIs may refers to same resource as like CRUD
                    operation on employee resource using HTTP verbs
                </li>
            </ul><br/><br/>
            Services like SOAP are centered on actions and processes.
            REST is centred on information and resources.
        </div>
        <div id="g1_3">
            Idempotence (mathematics and computer science) - is the property of certain operations when they can be
            <b>applied multiple times without changing</b>
            the result beyond the initial application.
            <br/>
            <br/>
            Idempotent <b class="r">operations</b> in REST:
            <ul>
                <li>{safe REST operations}</li>
                <li>PUT</li>
                <li>DELETE</li>
            </ul>
            Idempotence <b>allows requests caching</b> which leads to minimizing network load.

        </div>
        <div id="g1_4">
            <ul>
                <li>RESTful web services, <b>provide interoperability</b> between computer systems on the Internet (through API).
                </li>
                <li>Since good services are built to be stateless, they <b>can scale horizontally</b> just like regular
                    web
                    farms (a tried
                    and trusted pattern). And once a good caching strategy is devised, load on servers and latency for
                    consumers are both reduced.
                </li>
            </ul>
        </div>
        <div id="g1_5">
            Most important codes:
            <ul>
                <li><b>200</b> OK</li>
                <li><b class="r">201 Created</b> Created</li>
                <li><b class="r">204</b> No Content</li>
                <li>307 Temporary redirect</li>
                <li><b>400</b> Bad request</li>
                <li>401 Unauthorized</li>
                <li>404 Not found</li>
                <li><b class="r">403</b> Forbidden</li>
                <li>429 Too many requests</li>
                <li><b>500</b> Internal server error</li>
                <li>501 Not implemented</li>
                <li>503 Service unavailable</li>
            </ul>
        </div>
        <div id="g1_6">
            If an exception occurs during request mapping or is thrown from a request handler (such as a @Controller),
            the DispatcherServlet delegates to a <b>chain of HandlerExceptionResolver</b> beans to resolve the exception and
            provide alternative handling, which is typically an error response.<br/><br/>

            HandlerExceptionResolver implementations:
            <ul>
                <li><b>SimpleMappingExceptionResolver</b> - maps exception class names and error view names</li>
                <li><b>DefaultHandlerExceptionResolver</b> - maps exceptions raised by Spring MVC to HTTP status codes</li>
                <li><b>ResponseStatusExceptionResolver</b> - maps exceptions with the @ResponseStatus annotation to
                    HTTP status codes based on the value in the annotation</li>
                <li><b>ExceptionHandlerExceptionResolver</b> - calls @ExceptionHandler method in a @Controller or a @ControllerAdvice class</li>
            </ul>
        </div>
    </div>

    <div class="hidden">
        <div id="g2_1">
            Spring MVC is the core component for REST support so spring-webmvc.jar must be in the clsspath.
            <br/>
            Can be configured by Spring Boot starter: <b class="r">spring-boot-starter-web</b>
            <br/>
            <br/>

            REST controller can be annotated with specialization of @Controller - <b>@RestController</b>.
            The difference is only that @RestController defines @ResponseBody
            <br/>
            <br/>

            Conversions (is done by <b>HttpMessageConverter</b> implementations):
            <ul>
                <li>
                    <b>@RequestBody</b>
                    (can be applied on controller <b>method argument</b>) - access to the HTTP request
                    body.
                    Body content is converted to the declared method argument type by using HttpMessageConverter
                    implementations
                </li>
                <li>
                    <b>@ResponseBody</b>
                    (can be applied on controller <b>method</b>) serializes return value to the
                    response body
                    (versus view resolution and rendering with an HTML template)
                </li>
            </ul>
            <br/>

            In addition to <b>@RequestMapping</b> annotation there are also HTTP method specific specializations:
            <ul>
                <li>@GetMapping</li>
                <li>@PostMapping</li>
                <li>@PutMapping</li>
                <li>@DeleteMapping</li>
                <li>@PatchMapping</li>
            </ul>
        </div>
        <div id="g2_2">
            <b>@ResponseStatus</b> defines "code" and "reason" for HTTP response of controller method.
            <br/>
            <br/>

            The MVC Config automatically declares built-in resolvers for default Spring MVC exceptions, for
            @ResponseStatus
            annotated exceptions, and for support of @ExceptionHandler methods. You can customize that list or replace
            it.
        </div>
        <div id="g2_3">
            <b>@SessionAttributes</b> is used to store <b class="r">model attributes</b> in the
            <b class="r">HTTP Servlet session</b> between requests.
            It is a type-level annotation that declares the session attributes used by a specific controller.
            This typically lists the names of model attributes or types of model attributes that should be transparently
            stored in the session for subsequent requests to access.
        </div>
    </div>

    <div class="hidden">
        <div id="g3_1">
            <b>RestTemplate</b>
            - synchronous client to perform HTTP requests, exposing a simple, template method API over
            underlying HTTP client libraries such as the JDK {HttpURLConnection}, Apache HttpComponents, and others.

            <br/><br/>
            <b>HttpMethod</b>
            class with constants that can be used in RestTemplate: GET, HEAD, POST, PUT, PATCH, DELETE,
            OPTIONS, TRACE.

            <br/><br/>
            Example:<br/>
            String url = "http://localhost:8080/users/{$username}";<br/>
            User user = <b>restTemplate.getForObject</b>(url, User.class, "johncusack");

            <br/><br/>
            restTemplate methods automatically decode spaces in URL.<br/>
            <b class="r">The return type and the second parameter should be the same.</b>
        </div>
    </div>
</div>
<div>
    <h4>Testing</h4>
    <ul>
        <li>
            <b class="sub">Spring in testing:</b>
            <a title="h1_1">configuration</a>
            <a title="h1_2" class="label-warning">@Transactional</a>
            <a title="h1_3">mocks</a>
            <a title="h1_4">Spring Boot</a>
        </li>
    </ul>

    <div class="hidden">
        <div id="h1_1">
            <ul>
                <li>Annotate test with one of:
                    <ul>
                        <li><b>@RunWith(SpringJUnit4ClassRunner.class)</b></li>
                        <li><b>@SpringBootTest</b></li>
                        <li><b>@WebMvcTest(MyController.class)</b></li>
                    </ul>
                </li>
                <li>Annotate test with
                    <b>@ContextConfiguration</b>
                    (in case separate test configuration is needed)
                </li>
                <li>use <b>@Autowired</b> to inject beans to be tested
                </li>
            </ul>
            <br/>
            <b>TestContext</b> reuses <b>Application Contexts</b> in all tests/test classes from
            <b>static context cache</b> (unless @DirtiesContext is used)
            by configuration's location as a key.
            So if tests are running one by one using the same configuration - they will reuse the same AppContext.
        </div>
        <div id="h1_2">
            <b>@Transactional</b>
            behavior provides ability (method level) to run tests against real DB without any
            danger to the data - even if test deletes all the data in table those changes will be
            <b>automatically reverted</b> afterwards.
            <br/><br/>
            Transactional support is provided to a test via a
            <b>PlatformTransactionManager bean</b>
            defined in the test’s application context.
            <br/><br/>
            <b class="r">@Commit</b> - Spring's <b>test annotation</b> that forces test method to finalize it's work with commit
            instead of rolling back.
        </div>
        <div id="h1_3">
            <b>Mockito</b>
            and
            <b>EasyMock</b>
            framework allows the creation of test double objects (mock objects) in
            automated unit tests for the purpose of test-driven development (TDD) or behavior-driven development (BDD).
            <br/><br/>

            If mock object is wrapped with Spring Proxy developer can access target object and set some expected values using
            following utils: AopUtils and AopProxyUtils. However there is no direct support of those libraries in Spring.
            <br/><br/>
            Spring provides <b>mock objects</b> that you can use to test your code in isolation:<br/>
            <ul>
                <li><b class="r">Environment, PropertySource</b> (org.springframework.mock.env)</li>
                <li><b class="r">JNDI</b> (org.springframework.mock.jndi)</li>
                <li><b class="r">Servlet</b> (org.springframework.mock.web)</li>
                <li><b class="r">Portlets</b> (org.springframework.mock.web.portlet)</li>
                <li>etc.</li>
            </ul>
        </div>
        <div id="h1_4">
            Test support is provided by two modules:
            <ul>
                <li>
                    <b class="r">spring-boot-test</b> contains core items
                </li>
                <li>
                    <b>spring-boot-test-autoconfigure</b>
                    supports auto-configuration for tests
                </li>
            </ul>
            <br/>

            The
            <b class="r">spring-boot-starter-test</b>
            starter (in test scope) contains the following provided libraries:
            <ul>
                <li><b>JUnit</b>: The de-facto standard for unit testing Java applications.
                </li>
                <li>
                    <b>Spring Test + Spring Boot Test</b>: Utilities and integration test support for Spring Boot
                    applications.
                </li>
                <li><b>AssertJ</b>: A fluent assertion library.
                </li>
                <li>
                    <b>Hamcrest</b>: A library of matcher objects (also known as constraints or predicates).
                </li>
                <li><b>Mockito</b>: A Java mocking framework.
                </li>
                <li><b>JSONassert</b>: An assertion library for JSON.
                </li>
                <li><b>JsonPath</b>: XPath for JSON.
                </li>
            </ul>
            <br/>
            Spring Boot provides a <b>@SpringBootTest</b> with features:
            <ul>
                <li>Uses <b>SpringBootContextLoader</b> as the default ContextLoader when no specific
                    @ContextConfiguration(loader=...)
                </li>
                <li>Searches for a
                    <b>@SpringBootConfiguration</b>
                    when nested @Configuration is not used,
                    and no explicit classes are specified.
                </li>
                <li>Allows
                    <b>custom Environment</b>
                    properties to be defined using the properties attribute.
                </li>
                <li>Provides support for different <b>webEnvironment modes</b>, including the ability to
                    <b>start a fully running
                        web server
                    </b>
                    listening on a defined or random port.
                </li>
                <li>Registers a <b>TestRestTemplate</b> and/or
                    <b>WebTestClient</b>
                    bean for use in web tests that are using a fully
                    running web server.
                </li>
            </ul>
        </div>
    </div>
</div>

</body>
</html>
